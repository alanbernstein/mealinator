<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ name }} - Bernstein Recipes</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <nav class="recipe-nav">
        <a href="../index.html" class="back-link">&larr; Back to all recipes</a>
        <div class="view-controls">
            <label for="compactness">View:</label>
            <select id="compactness" class="compactness-select">
                <option value="normal">Normal</option>
                <option value="compact">Compact</option>
                <option value="very-compact">Very Compact</option>
            </select>
        </div>
    </nav>

    <main class="recipe-page">
        <article class="recipe">
            <header class="recipe-header">
                <h1>{{ name }}</h1>
                {% if tags %}
                <div class="recipe-tags">
                    {% for tag in tags %}
                    <span class="recipe-tag">{{ tag }}</span>
                    {% endfor %}
                </div>
                {% endif %}
            </header>

            {% if slug %}
            <div class="recipe-image-main">
                <img src="../images/mealie-{{ slug }}.jpg" alt="{{ name }}" onerror="this.onerror=null; this.parentElement.style.display='none'">
            </div>
            {% endif %}

            <div class="recipe-content">
                <section class="recipe-intro">
                    {% if description %}
                    <p class="recipe-description">{{ description }}</p>
                    {% endif %}
                    {% if org_url %}
                    <p class="recipe-source"><a href="{{ org_url }}" target="_blank">Original recipe</a></p>
                    <p class="recipe-source"><a href="https://cooked.wiki/{{ org_url }}" target="_blank">cooked.wiki</a></p>
                    {% endif %}
                </section>

                <div class="recipe-body">
                    {% if ingredients %}
                    <section class="recipe-ingredients">
                        <h2>Ingredients</h2>
                        <ul class="ingredient-list">
                            {% for ingredient in ingredients %}
                            <li>{{ ingredient }}</li>
                            {% endfor %}
                        </ul>
                    </section>
                    {% endif %}

                    {% if instructions %}
                    <section class="recipe-instructions">
                        <h2>Instructions</h2>
                        <ol class="instruction-list">
                            {% for instruction in instructions %}
                            <li><p>{{ instruction }}</p></li>
                            {% endfor %}
                        </ol>
                    </section>
                    {% endif %}

                    {% if comments %}
                    <section class="recipe-comments">
                        <h2>Comments</h2>
                        <p>{{ comments }}</p>
                    </section>
                    {% endif %}

                    {% if makes %}
                    <section class="recipe-makes">
                        <h2>Notes</h2>
                        <p>{{ makes }}</p>
                    </section>
                    {% endif %}
                </div>
            </div>
        </article>
    </main>

    <script>
        // Compactness control
        const compactnessSelect = document.getElementById('compactness');
        const recipePage = document.querySelector('.recipe-page');

        // Load saved preference
        const savedCompactness = localStorage.getItem('recipeCompactness') || 'normal';
        compactnessSelect.value = savedCompactness;
        recipePage.classList.add('view-' + savedCompactness);

        // Handle changes
        compactnessSelect.addEventListener('change', (e) => {
            const newValue = e.target.value;

            // Remove all view classes
            recipePage.classList.remove('view-normal', 'view-compact', 'view-very-compact');

            // Add new view class
            recipePage.classList.add('view-' + newValue);

            // Save preference
            localStorage.setItem('recipeCompactness', newValue);
        });
    </script>
</body>
</html>
